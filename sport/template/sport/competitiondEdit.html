<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Спартакиада СВФУ</title>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">
    <script type="text/javascript" src="{% static 'js/bootstrap.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery.js' %}"></script>
    <!--<script type="text/javascript" src="{% static 'my_js/js_table.js' %}"></script>-->


</head>
<body style=" background: rgb(51,122,183);">
  {% with counter=0 %}
  {% include 'sport/navbar.html' %}
  <div class="container">
    {% block edit %}
    <div class="container bg-light">
      <div class="row">
        <div class="container">
          {% if not save_error %}
          <form action="" method="post">
            {% csrf_token %}
              <div class="container">
                <div class="row">
                  <div class="col-md-9" style=" height: 91vh; overflow-y: scroll;">
                    <div class="form-group" style="border: 2px solid grey; border-radius: 5px; padding: 10px; margin-top: 15px;" >
                        <h5>Основные атрибуты соревнования</h5>
                        {{ form.as_p }}
                      </div>
                        <div class="form-group" id="judge_div" style="border: 2px solid grey; border-radius: 5px; padding: 10px;" >
                          <h5>Судьи</h5>

                                {{ formset.management_form }}
                                {% for form in formset %}
                                <!--<h6>Судья №{{ formset.count }}</h6>-->
                                <div class="form-group count {{ form.instance.id }}" id="forclone" style="border: 2px solid grey; border-radius: 5px; padding: 10px;">
                                  {{ form.as_table}}
                                </div>
                                <!--p class="kostyl" id="kostyl" style="display:none;">{{forloop.counter}}</p>-->
                                {% endfor %}

                        </div>
                        <div class="">
                          <button type="button" name="button" class="btn btn-block btn-primary" onclick="showform()">Добавить судью</button>
                        </div>
                        <!--{{ form_person.as_p }}-->
                  </div>
                  <div class="col-3" style=" height: 91vh;">
                    <div class="form-group">
                      <button type="submit" name="button" value="save" class="btn btn-block btn-dark" style="margin-top: 15px;">Сохранить</button>
                      {% if not create %}
                      <button type="submit" name="button" value="copy" class="btn btn-block btn-dark" style="margin-top: 15px;">Копировать</button>
                      <button type="submit" name="button" value="delete" class="btn btn-block btn-dark" style="margin-top: 15px;">Удалить</button>
                      {% endif %}
                    </div>

                  </div>
                </div>
              </div>

          </form>
          {% endif %}
          {% if save_error %}
          <label class="error" style="color: red;">{{ save_error }}</label>
          {% endif %}
        </div>
      </div>
      </div>
    {% endblock %}
  </div>

<script>
/*
$(document).ready(function(){
  $("#None").each(function() {
    console.log($(this).innerHTML);
    $(this).hide()
  });
});*/

//for(i=0;)
/*
  var a=0;
  var b=$(".kostyl").map(function() {return ($(this)).html()}).last()[0];
  b=parseInt(b);
  a=b;
  $(".None").hide();
  function showform(){
    $(".None-"+a).show()
    a--;
  }*/
  //$(".None").hide();
  i = $("#id_form-TOTAL_FORMS").attr("value");
  j = $("#id_form-INITIAL_FORMS").attr("value");
  console.log(i);
  function showform(){
    var data = $("#forclone").clone().appendTo("#judge_div");
    data.find("label").eq(0).attr("for","id_form-" + i + "-judge");
    data.find("label").eq(1).attr("for","id_form-" + i + "-judge_position");
    data.find("label").eq(2).attr("for","id_form-" + i + "-DELETE");
    data.find("select").eq(0).attr("name","form-" + i + "-judge");
    data.find("select").eq(0).attr("id","id_form-" + i + "-judge");
    data.find("select").eq(1).attr("name","form-" + i + "-judge_position");
    data.find("select").eq(1).attr("id","id_form-" + i + "-judge_position");
    data.find("input").eq(1).attr("value","");
    //data.find("input[id=id_form-"+ i +"-id]").attr("value","");
    data.find("input").eq(0).attr("name","form-" + i + "-DELETE");
    data.find("input").eq(1).attr("name","form-" + i + "-id");
    data.find("input").eq(0).attr("id","id_form-" + i + "-DELETE");
    data.find("input").eq(1).attr("id","id_form-" + i + "-id");
    i++;
    j++;
    $("#id_form-TOTAL_FORMS").attr("value", i);
    //$("#id_form-INITIAL_FORMS").attr("value", j);
  }
</script>
{% endwith %}
</body>
